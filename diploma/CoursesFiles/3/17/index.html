<p>Кроме класса Statement в java.sql мы можем использовать для выполнения запросов еще один класс - PreparedStatement. Кроме собственно выполнения запроса этот класс позволяет подготовить запрос, отформатировать его должным образом.</p>
<p>Например, в прошлых темах была создана таблица, которая имеет три столбца:</p>
<img src="../../CoursesFiles/3/17/img/1.jpg">
<p>С помощью PreparedStatement добавим в нее один объект:</p>
<br><img src="../../CoursesFiles/3/17/img/2.jpg"><br><img src="../../CoursesFiles/3/17/img/3.jpg"><br>
<p>В данном случае данные вводятся с консоли и затем добавляются в базу данных. Для создания объекта PreparedStatement применяется метод prepareStatement() класса Connection. В этот метод передается выражение sql INSERT INTO Products (ProductName, Price) Values (?, ?). Это выражение может содержать знаки вопроса ? - знаки подстановки, вместо которых будут вставляться реальные значения.</p>
<p>Чтобы связать отдельные знаки подстановки с конкретными значениями у класса PreparedStatement определен ряд методов для различных типов данных. Все методы, которые поставляют значения вместо знаков подстановки, в качестве первого параметра принимают порядковый номер знака подстановки (нумерация начинается с 1), а в качестве второго параметра - собственно значение, которое вставляется вместо знака подстановки.</p>
<p>Например, первый знак подстановки ? в выражении sql представляет значение для столбца ProductName, который хранит строку. Поэтому для связи значения с первым знаком подстановки применяется метод preparedStatement.setString(1, name).</p>
<p>Второй знак подстановки должен передавать значение для столбца Price, который хранит целые числа. Поэтому для вставик значения используется метод preparedStatement.setInt(2, price)</p>
<p>Кроме setString и setInt PreparedStatement имеет еще ряд подобных методов, которые работают подобным образом. Некоторые из них:</p>
<ul>
<li>setBigDecimal</li>
    <li>setBoolean</li>
    <li>setDate</li>
    <li>setDouble</li>
    <li>setFloat</li>
    <li>setLong</li>
    <li>setNull</li>
    <li>setTime</li>
</ul>
<p>Для выполнения запроса PreparedStatement имеет три метода:</p>
<ul>
    <li>boolean execute(): выполняет любую SQL-команду</li>
    <li>ResultSet executeQuery(): выполняет команду SELECT, которая возвращает данные в виде ResultSet</li>
    <li>int executeUpdate(): выполняет такие SQL-команды, как INSERT, UPDATE, DELETE, CREATE и возвращает количество измененных строк</li>
</ul>
<p>При этом в отличие от методов Statement эти методы не принимают SQL-выражение.</p>
<p>Пример выполнения программы:</p>
<img src="../../CoursesFiles/3/17/img/4.jpg" style="width: 50%">
<p>Подобным образом мы можем выполнять и другие выражения. Например, получим товары, у которых цена меньше 50000:</p>
<img src="../../CoursesFiles/3/17/img/5.jpg">
<style>p{text-indent: 25px}img{width: 100%}</style>