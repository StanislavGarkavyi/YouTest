<p>Маршрутизация позволяет сопоставлять запросы к приложению с определенными ресурсами внутри приложения. Рассмотрим, как использовать маршрутизацию Angular в связке с ASP.NET Core. Возьмем, к примеру приложение из прошлой темы:</p>
<img src="../../CoursesFiles/4/28/img/1.jpg" style="width: 30%">
<p>В частности, в проекте определен контроллер ProductController:</p>
<br><img src="../../CoursesFiles/4/28/img/2.jpg"><br><img src="../../CoursesFiles/4/28/img/3.jpg"><br><img src="../../CoursesFiles/4/28/img/4.jpg"><br><img src="../../CoursesFiles/4/28/img/5.jpg"><br>
<p>И в папке ClientApp/app в файле data.service.ts определен сервис, который отправляет запрос к этому контроллеру:</p>
<br><img src="../../CoursesFiles/4/28/img/6.jpg"><br><img src="../../CoursesFiles/4/28/img/7.jpg"><br>
<p>Вначале добавим в папку ClientApp/app новый файл product-detail.component.ts, который будет выводить данные об одном товаре:</p>
<br><img src="../../CoursesFiles/4/28/img/8.jpg"><br><img src="../../CoursesFiles/4/28/img/9.jpg"><br>
<p>Здесь мы предполагаем, что этому компоненту через параметр маршрута будет передаваться идентификатор товара, информацию о котором надо отобразить. В конструкторе через объект типа ActivatedRoute (activeRoute.snapshot.params["id"]) мы можем получить значение id товара и сохранить его в переменную. В данном случае параметр маршрута будет также называться "id".</p>
<p>Затем в методе ngOnInit() отправляем серверу запрос, в который передаем ранее полученный id, и в качетве ответа от сервера получаем нужный нам товар. А с помощью дополнительной переменной loaded мы можем указать, что данные загружены.</p>
<p>Для вывода информации о товаре компонент будет использовать файл product-detail.component.html. Поэтому добавим этот файл в папку ClientApp/app и определим в нем следующее содержимое:</p>
<img src="../../CoursesFiles/4/28/img/10.jpg">
<p>Если данные загружены с сервера (то есть переменная loaded равна true), то будут выводиться данные о товаре.</p>
<p>В конце файла определена ссылка на корень приложения. Чтобы привязать ссылку к определенному адресу внутри приложения Angular, у элемента ссылки устанавливается атрибут routerLink, который указывает на нужный адрес. В данном случае в качестве адреса применяется "/", то есть корневой адрес приложения, по которому будет выводиться список товаров.</p>
<p>Теперь добавим в папку ClientApp/app новый файл product-list.component.ts, который будет собственно и будет представлять список товаров:</p>
<img src="../../CoursesFiles/4/28/img/11.jpg">
<p>При загрузке компонента будут загружаться данные с сервера с помощью метода this.dataService.getProducts(). Для вывода данных определим в той же папке файл product-list.component.html:</p>
<img src="../../CoursesFiles/4/28/img/12.jpg">
<p>Здесь выводится список объектов. Для каждого объекта выводится только значение поля name, которое заключено в ссылку. Данная ссылка указывает на определенный путь внутри приложения Angular, который определяется с помощью атрибута [routerLink]. При этом теперь этот атрибут фактически принимает массив компонентов, из которых будет создаваться путь. Для создания пути передается строка "product" и id элемента. То есть в итоге получатся пути типа "product/3" или "product/5". Предполагается, что при переходе по таким путям мы будет попадать на компонент ProductDetailComponent, который будет получать id и выводить информацию о товаре.</p>
<p>Теперь изменим файл модуля app.module.ts, в котором сопоставим компоненты с определенными маршрутами:</p>
<br><img src="../../CoursesFiles/4/28/img/13.jpg"><br><img src="../../CoursesFiles/4/28/img/14.jpg"><br>
<p>Прежде всего здесь определены маршруты в виде объекта Route. Первый маршурт сопоставляется с корнем сайта и будет обрабатываться компонентом ProductListComponent:</p>
<img src="../../CoursesFiles/4/28/img/15.jpg">
<p>Второй маршрут будет сопоставляться с путем "product/id", где вместо id будет указан идентификатор товара. И такой маршрут будет обрабатываться компонентом ProductDetailComponent:</p>
<img src="../../CoursesFiles/4/28/img/16.jpg">
<p>Для всех остальных путей ("**") будет идти переадресация на корень приложения.</p>
<p>И другой важный момент состоит в импорте всех нужных модулей:</p>
<img src="../../CoursesFiles/4/28/img/17.jpg">
<p>и в добавлении всех ранее используемых компонентов:</p>
<img src="../../CoursesFiles/4/28/img/18.jpg">
<p>Теперь изменим определение главного компонента AppComponent в файле app.component.ts:</p>
<img src="../../CoursesFiles/4/28/img/19.jpg">
<p>И определим в файле app.component.html следующий код:
</p>
<img src="../../CoursesFiles/4/28/img/20.jpg">
<p>В элемент router-outlet как раз и будет загружаться выбранный для обработки маршрута компонент.</p>
<p>И еще один важный момент, который надо учитывать при работе с маршрутизацией: на веб-странице должен быть указан элемент base:</p>
<img src="../../CoursesFiles/4/28/img/21.jpg">
<p>В частности, веб-страница index.html, которая расположена в проекте в папке wwwroot и которая загружается по умолчанию, должна содержать этот элемент:</p>
<img src="../../CoursesFiles/4/28/img/22.jpg">
<p>Запустим приложение, и по умолчанию будет идти запрос к корню приложения, а значит такой запрос будет обрабатываться компонентом ProductListComponent, который выведет список товаров:
</p>
<img src="../../CoursesFiles/4/28/img/23.jpg" style="width: 50%; margin-left: 25%">
<p>Если мы перейдем по ссылке, которую представляет товар, то такой запрос будет обрабатываться компонентом ProductDetailComponent, и соответственно мы в браузере увидим информацию о товаре:</p>
<img src="../../CoursesFiles/4/28/img/24.jpg" style="width: 50%; margin-left: 25%">
<style>p{text-indent: 25px;}img{width: 100%}</style>