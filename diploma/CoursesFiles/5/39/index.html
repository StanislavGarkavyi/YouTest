<p>Процесс добавления данных разбивается на две части. Вначале нам надо показать пользователю форму для ввода данных. Затем, когда пользователь отправит введенные данные, нам надо их получить и добавить в базу данных.</p>
<p>Возьмем проект из прошлой темы. И прежде всего добавим в папку templates новый файл create.html, который будет содержать форму для добавления:</p>
<img src="../../CoursesFiles/5/39/img/1.jpg"><br><img src="../../CoursesFiles/5/39/img/2.jpg" style="width: 25%!important">
<p>Изменим файл сервера следующим образом:</p>
<br><img src="../../CoursesFiles/5/39/img/3.jpg"><br><img src="../../CoursesFiles/5/39/img/4.jpg"><br><img src="../../CoursesFiles/5/39/img/5.jpg"><br><img src="../../CoursesFiles/5/39/img/7.jpg"><br>
<p>Для добавления данных определена функция CreateHandler(). Поскольку нам надо, с одной стороны, отображать пользователю форму для добавления, а, с другой стороны, получать и добавлять данные в БД, то данная функция условно разделена на две части. В ней мы проверяем тип запроса. Если запрос представляет тип "GET", то мы будем возвращать форму для добавления. Если запрос имеет тип "POST", то парсим данные полученной формы и извлекаем из них нужные элементы.</p>
<p>Для извлечения нужных данных из полученных форм применяется метод r.FormValue(). В качестве параметра этому методу передается название данных. То есть, например, на форме есть следующее поле:</p>
<img src="../../CoursesFiles/5/39/img/8.jpg">
<p>Атрибут name указывает, что название этого поля - "model". Следовательно, чтобы получить введенные в него данные, необходимо использовать выражение model := r.FormValue("model").</p>
<p>После получения всех данных они добавляются в БД с помощью метода database.Exec:</p>
<img src="../../CoursesFiles/5/39/img/9.jpg">
<p>После этого выполняется переадресация на корень сайта с помощью функции http.Redirect:</p>
<img src="../../CoursesFiles/5/39/img/10.jpg">
<p>Третий параметр указывает путь переадресации. В данном случае "/", по которому выводится список объектов из БД. Четвертый параметр представляет статусный код переадресации. В данном случае код 301 указывает, что переадресация временная.</p>
<p>Если же запрос к серверу представляет тип GET, то просто возвращаем пользователю веб-страницу create.html:</p>
<img src="../../CoursesFiles/5/39/img/11.jpg">
<p>Функция IndexHandler, которая возвращает список объектов, остается той же, что и в прошлой теме.</p>
<p>Ну и в функции main CreateHandler устанавливаеncя в качестве обработчика по пути "/create":</p>
<img src="../../CoursesFiles/5/39/img/12.jpg">
<p>Запустим приложение. Перейдем по пути "http://localhost:8181/create", и нам отобразится форма. Введем в нее какие-нибудь данные:</p>
<img src="../../CoursesFiles/5/39/img/13.jpg" style="width: 50%">
<p>И после отправки формы приложение получит данные, добавит их в БД и переадресует на главную страницу:</p>
<img src="../../CoursesFiles/5/39/img/14.jpg" style="width: 50%">
<style>p{text-indent: 25px;}img{width: 100%}</style>
