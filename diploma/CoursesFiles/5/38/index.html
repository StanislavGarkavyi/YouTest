<p>Рассмотрим, как мы можем взаимодействовать с базой данных в веб-приложении. Основные моменты работы с бд с помощью языка программирования Go были рассмотрены в материале Go и базы данных. В данном же случае мы рассмотрим только непосредственно применение этих моментов в рамках веб-приложения.</p>
<p>В качестве системы управления базами данных возьмем MySQL. Вначале создадим на сервере MySQL базу данных productdb и в ней таблицу products. Для этого можно использовать следующие выражений SQL</p>
<img src="../../CoursesFiles/5/38/img/1.jpg">
<p>То есть база данных productdb, в ней есть таблица products, которая будет хранить информацию о товарах, будет 4 столбца: id - идентификатор каждой записи, model - название товара, company - производитель товара и price - цена товара.</p>
<p>Добавим в нее какие-нибудь начальные данные, например, с помощью следующего скрипта:</p>
<img src="../../CoursesFiles/5/38/img/2.jpg">
<p>Прежде чем начать работать с MySQL, надо добавить драйвер для Go к переменной $GOPATH (если он ранее не был добавлен). Для этого нужно выполнить в командной строке/терминале следующую команду:</p>
<img src="../../CoursesFiles/5/38/img/3.jpg">
<p>После этого определим на сервере следующий код:</p>
<br><img src="../../CoursesFiles/5/38/img/4.jpg"><br><img src="../../CoursesFiles/5/38/img/5.jpg"><img src="../../CoursesFiles/5/38/img/6.jpg"><br>
<p>Прежде всего здесь определена структура Product, которая соответствует опредению таблицы products в базе данных. А за взаимодействие с базой данных отвечает переменная database.</p>
<p>Для отправки пользователю списка объектов из БД определена функция IndexHandler. В ней с помощью метода database.Query выполняется запрос "select * from productdb.Products", который извлекает все объекты из таблицы. Затем из полученного набора создается массив структур Product, который затем передается в шаблон index.html (код шаблона приведен ниже).</p>
<p>В функции main открываем подключение с базой данных с помощью функции sql.Open:</p>
<img src="../../CoursesFiles/5/38/img/7.jpg">
<p>Этой функции в качестве первого параметра передается название драйвера - "mysql". Второй параметр представляет настройки подключения, где root - название пользователя в MySQL, password - пароль этого пользователя (как правило тот, который устанавливается при установке MySQL), и productdb - название базы данных. Соответственно в каждом конкретном случае пароль может отличаться.</p>
<p>После открытия подключения устанавливается значение переменной database.</p>
<img src="../../CoursesFiles/5/38/img/8.jpg">
<p>И далее функция IndexHandler устанавливается в качестве обработчика запросов по корневому адресу:</p>
<img src="../../CoursesFiles/5/38/img/9.jpg">
<p>Теперь определим в проекте папку templates, а в ней создадим новый файл index.html, который будет представлять шаблон для вывода массива объектов и будет иметь следующий код:</p>
<img src="../../CoursesFiles/5/38/img/10.jpg">
<p>В итоге после запуска проекта и обращения к корню сайта будет открыто подключение к базе данных, приложение получит все необходимые данные из бд и передаст их в шаблон:</p>
<img src="../../CoursesFiles/5/38/img/11.jpg">
<style>p{text-indent: 25px;}</style>
<p></p>