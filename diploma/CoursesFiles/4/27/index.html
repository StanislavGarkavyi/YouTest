<p><b>HttpResponse</b></p>
<p>В прошлой теме после отправки запроса в качестве ответа мы получали некоторый объект json, сконструированный на основе пришедших от сервера данных. Например, код отправки данных через запрос POST:</p>
<img src="../../CoursesFiles/4/27/img/1.jpg">
<p>В классе компонента мы используем этот метод:</p>
<img src="../../CoursesFiles/4/27/img/2.jpg">
<p>Здесь мы ожидаем, что сервер нам возвратит объект Product - добавленный объект. На стороне сервера этот запрос обрабатывается методом post:</p>
<img src="../../CoursesFiles/4/27/img/3.jpg">
<p>Таким образом, сервер отправляет объект Product, и на клиенте мы этот объект получаем. Но что если кроме собственно данных мы захотим получить дополнительную информацию о запросе, например, статусный код ответа, заголовки ответа и т.д.? В этом случае на сторое клиента мы можем применять тип HttpResponse, который расположен в пакете @angular/common/http. Этот тип определяет следующие свойства:</p>
<ul>
    <li>body: собственно данные, отправленные сервером</li>
    <li>headers: объект HttpHeaders, представляющий коллекцию заголовков ответа</li>
    <li>status: числовой код статуса ответа</li>
    <li>statusText: текст статуса</li>
    <li>ok: возвращает true, если запрос успешно обработан</li>
    <li>url: адрес ресурса</li>
</ul>
<p>Для использования HttpResponse изменим метод createProduct() в сервисе DataService:</p>
<img src="../../CoursesFiles/4/27/img/4.jpg">
<p>Теперь в компоненте AppComponent получим данные:</p>
<br><img src="../../CoursesFiles/4/27/img/5.jpg"><br><img src="../../CoursesFiles/4/27/img/6.jpg"><br>
<img src="../../CoursesFiles/4/27/img/7.jpg"><br><p></p>
<p>Теперь полученные данные представляют объект HttpResponse. И поскольку сервер по прежнему посылает объект Product, который был добавлен в БД, то HttpResponse типизрован типом Product:</p>
<img src="../../CoursesFiles/4/27/img/8.jpg">
<p>Через свойство body можно получить отправленный объект Product. Также можно получить другие данные из HttpResponse.</p>
<p>Добавим новый объект и в консоли браузера мы сможем детально проинспектировать полученный ответ:</p>
<img src="../../CoursesFiles/4/27/img/9.jpg">
<p>И подобным образом мы можем получить другие данные из ответа, например, получим значение заголовка "content-type", который указывает на тип содержимого в ответе:</p>
<img src="../../CoursesFiles/4/27/img/10.jpg">
<p><b>Отправка пустого ответа</b></p>
<p>Иногда сервер получает запрос, обрабатывает его и отправляет пустой ответ. Допустим, пусть в контроллере метод Put, который обновляет объект в бд, не отправляет в ответ никаких данных:</p>
<img src="../../CoursesFiles/4/27/img/11.jpg">
<p>Вызов return Ok(); отправляет ответ, но при этом не посылает никаких данных.</p>
<p>По умолчанию при обработке полученного от сервера ответа Angular пытается преобразовать полученные данные в объект json. Однако поскольку сервер никаких данных не отправляет, то Angular не сможет сконструировать объект json, и поэтому, несмотря на успешную вроде бы обработку запроса, в консоли мы получим ошибку "SyntaxError: Unexpected end of JSON input at JSON.parse":</p>
<img src="../../CoursesFiles/4/27/img/12.jpg">
<p>С этой же ошибкой мы можем столкнуться, если сервер отправляет текстовое содержимое, например:</p>
<img src="../../CoursesFiles/4/27/img/13.jpg">
<p>И чтобы избежать ошибки при отправке запроса необходимо установить, что мы хотим получить именно текст, а не json. Для этого изменим метод updateProduct в сервисе DataService:</p>
<img src="../../CoursesFiles/4/27/img/14.jpg">
<p>Теперь Angular не будет пытатьcя преобразовать полученные от сервера данные в json.</p>
<p>Также можно комбинировать оба выше рассмотренных параметра:</p>
<img src="../../CoursesFiles/4/27/img/15.jpg">
<style>p{text-indent: 25px;}img{width: 100%}</style>